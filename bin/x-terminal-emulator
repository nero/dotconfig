#!/bin/sh
# automatically pick a terminal emulator
fail() {
        echo "$1" >&2
        exit 1
}

cmd_exists() {
        command -v "$1" >/dev/null 2>&1
}

if test -n "$WAYLAND_DISPLAY" && cmd_exists foot; then
  cfg="${XDG_CONFIG_HOME}"/foot/foot.ini
  if ! foot -c "$cfg" --check-config; then
    cfg="${XDG_CONFIG_HOME}"/foot/foot-$(foot -v|cut -d' ' -f3|cut -d'.' -f1-2).ini
  fi
  exec foot -c "$cfg" "$@"
elif cmd_exists xterm; then
  exec xterm -maximized "$@"
elif cmd_exists urxvtd; then
  export RXVT_SOCKET="${XDG_RUNTIME_DIR}/rxvt${DISPLAY}.sck"
  urxvtc "$@"
  if [ $? -eq 2 ]; then
    urxvtd -q -o -f
    urxvtc "$@"
  fi
  exit
elif cmd_exists urxvt; then
  exec urxvt "$@"
elif test -x /usr/bin/x-terminal-emulator; then
  exec /usr/bin/x-terminal-emulator "@"
else
  fail "No emulator found"
fi
