#!/bin/sh
# key-value store encrypted with gpg
# this is similar to the `pass` secrets manager
# requires gpg keypair on machine
cd "$HOME/.secrets" || exit 1
echo() {
  printf "%s\n" "$1"
}
case "$1" in
list) find . -name '*.gpg' | sed 's|^./||;s|\.gpg$||' ;;
set)  gpg --output "${2}".gpg --encrypt $(cat recipients) ;;
get)  echo "$(gpg --decrypt "${2}".gpg)" ;;
gen)  cookie 75;;
*)    exit 1 ;;
esac
