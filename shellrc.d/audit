session_log_event() {
  (
  echo $(date -Iseconds) $(tty 2>&1|sed 's/.* .*/"&"/g') $$ "$@" >> "~/log/shell.log"
  ) 2>/dev/null
}

session_exit_hook() {
  session_log_event close
}

session_log_event open $- ${DISPLAY} ${SSH_CLIENT%% *}

trap session_exit_hook EXIT
